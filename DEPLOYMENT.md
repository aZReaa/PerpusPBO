# Deployment Checklist untuk Render

## âœ… Persiapan Deployment

### 1. File yang Sudah Dibuat
- [x] `render.yaml` - Konfigurasi utama Render
- [x] `build.sh` - Script build untuk Linux
- [x] `build.ps1` - Script build untuk Windows (development)
- [x] `Procfile` - Alternative web service config
- [x] `requirements.txt` - Dependencies dengan gunicorn dan psycopg2
- [x] `.gitignore` - File yang diabaikan git
- [x] `README.md` - Dokumentasi lengkap
- [x] Upload directory placeholders

### 2. Modifikasi Aplikasi
- [x] Environment variable support untuk DATABASE_URL
- [x] SECRET_KEY dari environment variable
- [x] ADMIN_PASSWORD dari environment variable (untuk keamanan)
- [x] PostgreSQL compatibility
- [x] Production vs development configuration
- [x] File upload directory configuration

## ğŸš€ Langkah Deployment

### Step 1: Push ke GitHub
```bash
git init
git add .
git commit -m "Initial commit - ready for deployment"
git branch -M main
git remote add origin https://github.com/USERNAME/perpustakaan-app.git
git push -u origin main
```

### Step 2: Setup di Render.com

1. Login ke [Render.com](https://render.com)
2. Klik "New" dan pilih "Blueprint"
3. Connect ke repository GitHub Anda
4. Render akan otomatis mendeteksi `render.yaml` dan setup:
   - Web service untuk aplikasi Flask
   - PostgreSQL database
   - Environment variables

### Step 3: Database Migration

Aplikasi ini akan otomatis melakukan migrasi dari SQLite ke PostgreSQL di Render. Proses ini termasuk:

1. **Setup Table**: `db.create_all()` di `build.sh` akan membuat table di PostgreSQL
2. **Admin Creation**: Admin user akan dibuat otomatis dengan password random (lihat di Dashboard Render)
3. **Data Import**: Untuk memindahkan data dari development ke production, gunakan script migrasi (lihat bagian Database Migration di bawah)

## ğŸ“Š Database Migration

Untuk memindahkan data dari SQLite ke PostgreSQL, gunakan script `migrate_data.py`:

### Export data dari SQLite (development)
```bash
# Di komputer development
python migrate_data.py export
```
Ini akan membuat folder `migration` dengan file JSON untuk semua data.

### Import data ke PostgreSQL (production)

**Opsi 1: Manual upload ke Render**
1. Upload folder `migration` ke Render
2. Jalankan import melalui Shell di dashboard Render:
```bash
DATABASE_URL=$DATABASE_URL python migrate_data.py import
```

**Opsi 2: Local import dengan DATABASE_URL**
1. Dapatkan DATABASE_URL dari dashboard Render
2. Jalankan locally:
```bash
DATABASE_URL=postgres://... python migrate_data.py import
```

> **PERHATIAN**: Saat migrasi, password user akan direset ke `ChangeMeNow!`

### Step 2: Deploy di Render
1. Login ke https://render.com
2. Klik "New +" â†’ "Blueprint"
3. Connect GitHub repository
4. Render akan otomatis detect `render.yaml`
5. Review konfigurasi dan deploy

### Step 3: Verifikasi Deployment
- Database PostgreSQL akan dibuat otomatis
- Admin user akan dibuat: `admin` / `admin123`
- App akan tersedia di URL yang diberikan Render

## ğŸ“‹ Environment Variables (Auto-configured)

- `SECRET_KEY`: Auto-generated by Render
- `DATABASE_URL`: Auto-set by PostgreSQL service
- `PYTHON_VERSION`: 3.11.0

## ğŸ”§ Local Development

```bash
# Install dependencies
pip install -r requirements.txt

# Run aplikasi
python app.py
```

## ğŸ“‚ File Structure untuk Deployment

```
perpustakaan-app/
â”œâ”€â”€ app.py                 # Main Flask application
â”œâ”€â”€ requirements.txt       # Python dependencies
â”œâ”€â”€ render.yaml           # Render configuration
â”œâ”€â”€ build.sh              # Build script for Linux
â”œâ”€â”€ Procfile              # Alternative web service
â”œâ”€â”€ README.md             # Documentation
â”œâ”€â”€ .gitignore            # Git ignore rules
â”œâ”€â”€ static/               # CSS, JS, images
â”‚   â”œâ”€â”€ uploads/
â”‚   â”‚   â”œâ”€â”€ books/.gitkeep
â”‚   â”‚   â””â”€â”€ profiles/.gitkeep
â””â”€â”€ templates/            # HTML templates
```

## âš ï¸ Important Notes

1. **File Uploads**: Dalam production, upload files akan tersimpan di local storage Render. Untuk aplikasi yang serius, pertimbangkan cloud storage (AWS S3, Cloudinary, dll.)

2. **Database**: Aplikasi akan otomatis switch dari SQLite (development) ke PostgreSQL (production) berdasarkan environment variable.

3. **Admin Access**: Setelah deployment, login dengan:
   - Username: `admin`
   - Password: `admin123`
   - **PENTING**: Ubah password admin setelah deployment pertama!

4. **HTTPS**: Render otomatis menyediakan SSL certificate untuk aplikasi.

## ğŸ› Troubleshooting

### Jika Build Gagal:
- Check build logs di Render dashboard
- Pastikan semua dependencies ada di `requirements.txt`
- Pastikan `build.sh` executable

### Jika Database Error:
- Check environment variables di Render dashboard
- Pastikan PostgreSQL service sudah running
- Check database connection string

### Jika App Tidak Load:
- Check web service logs
- Pastikan gunicorn command benar: `gunicorn app:app`
- Check port configuration (Render auto-assigns)

## ğŸ“ Support

Jika ada masalah deployment:
1. Check Render documentation: https://render.com/docs
2. Review build dan web service logs
3. Pastikan semua files sudah di-commit ke GitHub
